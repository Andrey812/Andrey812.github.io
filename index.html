<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head>
    <title>Andrey's blog</title>
    <link rel="stylesheet" type="text/css" href="style/main.css">
    <meta charset="utf-8">
 </head>
 <body>
    <div class="flow">

<!-- post 1 BEGIN -->
        <div class="post">
            <span class="title">
                <h3>Mojolicious HTTP client</h3>
            </span>
            <span class="info">
                24 Apr 2014 15:48 [1398340126]</span>
            <span class="data">
                <p>
                Недавно мне пришлось решать задачу получения данных с web
                сервера по HTTP протоколу с проверкой cookie авторизации
                на Perl. Однако, вместо использования стандартного для таких
                целей LWP, нужно было написать решение при помощи Mojolicious
                Useragent.
                </p>
                <span class="code">
#!/usr/bin/perl

use 5.010;

use strict;
use warnings;

use Mojo::UserAgent;

my $ua = Mojo::UserAgent->new;

$ua->on(start => sub {
    my ($ua, $tx) = @_;
    $tx->req->cookies({name => 'user_auth', value => '8044d756b7f00b695ab8dce07dce43e5'});
});

my $tx = $ua->get('http://example.com');

my $res;

unless ($res = $tx->success) {
    my ($err, $code) = $tx->error;
    warn ($code ? "$code response: $err" : "Connection error: $err");
};

say $res->body;

# Необязательная часть, но полезная, если нужно "пробросить"
# ответ сервера через Mojolicious web сервер клиенту
# $self->tx->res($res);
# $self->rendered($res->code);
                </span>
            </span>
            <span class="bottom">
                <p></p>
                <!--
                <p>VK&nbsp;FB&nbsp;Twitter</p>
                -->
            <span>
        </div>
<!-- post 1 END -->

    <!-- Common footer BEGIN -->
        <div class="common_footer">
            <p>Andrey's blog. Copyright by Andrey Nikolaev.</p>
        </div>
    <!-- Common footer BEGIN -->
    </div>

 </body>
 </html>
